!function(){"use strict";var e=document.getElementById("last-period"),t=document.getElementById("calc-btn"),n=document.getElementById("reset-btn"),a=document.getElementById("result"),r=document.getElementById("current-week"),o=document.getElementById("due-date"),s=document.getElementById("days-remaining"),l=document.getElementById("trimester"),d=document.getElementById("timeline-section"),m=document.getElementById("timeline-body");function c(e,t){var n=new Date(e);return n.setDate(n.getDate()+t),n}t.addEventListener("click",function(){var t=e.value;if(t){var n=new Date(t);n.setHours(0,0,0,0);var i=new Date;i.setHours(0,0,0,0);var u=c(n,280),k=Math.floor((i-n)/864e5);if(k<0)alert("最終月経開始日が未来の日付です。正しい日付を入力してください。");else if(k>310)alert("最終月経開始日が44週以上前です。正しい日付を入力してください。");else{var f,h=Math.floor(k/7),g=k%7,W=Math.floor((u-i)/864e5),x=function(e){return e<0?{label:"妊娠前",color:"#6b7280"}:e<16?{label:"妊娠初期（1〜4ヶ月）",color:"#f59e0b"}:e<28?{label:"妊娠中期（5〜7ヶ月）安定期",color:"#22c55e"}:e<40?{label:"妊娠後期（8〜10ヶ月）",color:"#3b82f6"}:{label:"出産予定日超過",color:"#ef4444"}}(h);r.textContent="妊娠"+h+"週"+g+"日",r.style.color=x.color,o.textContent=(f=u).getFullYear()+"年"+("0"+(f.getMonth()+1)).slice(-2)+"月"+("0"+f.getDate()).slice(-2)+"日（"+["日","月","火","水","木","金","土"][f.getDay()]+"）",l.textContent=x.label,l.style.color=x.color,W>0?s.textContent="あと"+W+"日":0===W?(s.textContent="本日が出産予定日です",s.style.color="#ef4444"):(s.textContent="出産予定日を"+Math.abs(W)+"日超過",s.style.color="#ef4444"),function(e){m.innerHTML="";var t=[{name:"妊娠初期",weeks:"0〜15週",months:"1〜4ヶ月",startWeek:0,endWeek:15,features:"つわり、眠気、胎児の器官形成"},{name:"├ 妊娠超初期",weeks:"0〜3週",months:"1ヶ月",startWeek:0,endWeek:3,features:"受精・着床、自覚症状なし"},{name:"├ 妊娠2ヶ月",weeks:"4〜7週",months:"2ヶ月",startWeek:4,endWeek:7,features:"つわり開始、妊娠検査薬で陽性"},{name:"├ 妊娠3ヶ月",weeks:"8〜11週",months:"3ヶ月",startWeek:8,endWeek:11,features:"つわりのピーク、心拍確認"},{name:"└ 妊娠4ヶ月",weeks:"12〜15週",months:"4ヶ月",startWeek:12,endWeek:15,features:"つわり軽減、胎盤完成"},{name:"妊娠中期",weeks:"16〜27週",months:"5〜7ヶ月",startWeek:16,endWeek:27,features:"安定期、胎動、お腹のふくらみ"},{name:"├ 妊娠5ヶ月",weeks:"16〜19週",months:"5ヶ月",startWeek:16,endWeek:19,features:"安定期入り、胎動を感じ始める"},{name:"├ 妊娠6ヶ月",weeks:"20〜23週",months:"6ヶ月",startWeek:20,endWeek:23,features:"胎動活発、性別判明の可能性"},{name:"└ 妊娠7ヶ月",weeks:"24〜27週",months:"7ヶ月",startWeek:24,endWeek:27,features:"お腹が目立つ、足のむくみ"},{name:"妊娠後期",weeks:"28〜39週",months:"8〜10ヶ月",startWeek:28,endWeek:39,features:"出産準備、健診頻度増加"},{name:"├ 妊娠8ヶ月",weeks:"28〜31週",months:"8ヶ月",startWeek:28,endWeek:31,features:"逆子チェック、産休開始目安"},{name:"├ 妊娠9ヶ月",weeks:"32〜35週",months:"9ヶ月",startWeek:32,endWeek:35,features:"出産準備、入院グッズの用意"},{name:"└ 妊娠10ヶ月",weeks:"36〜39週",months:"10ヶ月",startWeek:36,endWeek:39,features:"正期産（37週〜）、いつでも出産OK"}],n=new Date;n.setHours(0,0,0,0);for(var a=Math.floor((n-e)/864e5),r=Math.floor(a/7),o=0;o<t.length;o++){var s=t[o],l=document.createElement("tr");l.style.borderBottom="1px solid var(--color-border-light)",r>=s.startWeek&&r<=s.endWeek&&(l.style.background="var(--color-primary-light, #dbeafe)");var i=-1===s.name.indexOf("├")&&-1===s.name.indexOf("└")?"600":"400",u=c(e,7*s.startWeek),k=c(e,7*(s.endWeek+1)-1),f=u.getMonth()+1+"/"+u.getDate()+"〜"+(k.getMonth()+1)+"/"+k.getDate(),h=document.createElement("td");h.style.cssText="padding: 8px; text-align: left; font-weight: "+i+";",h.textContent=s.name;var g=document.createElement("td");g.style.cssText="padding: 8px; text-align: center;",g.textContent=s.weeks;var W=document.createElement("td");W.style.cssText="padding: 8px; text-align: center;",W.textContent=s.months;var x=document.createElement("td");x.style.cssText="padding: 8px; text-align: center; font-size: 0.8rem;",x.textContent=f;var p=document.createElement("td");p.style.cssText="padding: 8px; text-align: left; font-size: 0.8rem;",p.textContent=s.features,l.appendChild(h),l.appendChild(g),l.appendChild(W),l.appendChild(x),l.appendChild(p),m.appendChild(l)}d.hidden=!1}(n),a.hidden=!1,a.scrollIntoView({behavior:"smooth"})}}else alert("最終月経開始日を入力してください。")}),n.addEventListener("click",function(){e.value="",a.hidden=!0,d.hidden=!0,m.innerHTML=""})}();