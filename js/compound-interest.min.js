document.addEventListener('DOMContentLoaded', function () {
'use strict';
var principalInput = document.getElementById('principal');
var rateInput = document.getElementById('rate');
var yearsInput = document.getElementById('years');
var monthlyInput = document.getElementById('monthly');
var calcBtn = document.getElementById('calc-btn');
var resetBtn = document.getElementById('reset-btn');
var resultSection = document.getElementById('result');
var tableContainer = document.getElementById('table-container');
var yearlyTbody = document.getElementById('yearly-tbody');
var resultTotal = document.getElementById('result-total');
var resultInvested = document.getElementById('result-invested');
var resultProfit = document.getElementById('result-profit');
var resultReturnRate = document.getElementById('result-return-rate');
function formatYen(val) {
return Math.round(val).toLocaleString() + '円';
}
calcBtn.addEventListener('click', function () {
var principal = parseFloat(principalInput.value) || 0;
var rate = parseFloat(rateInput.value);
var years = parseInt(yearsInput.value, 10);
var monthly = parseFloat(monthlyInput.value) || 0;
if (isNaN(rate) || rate < 0) {
alert('年利率を正しく入力してください。');
return;
}
if (isNaN(years) || years < 1 || years > 100) {
alert('運用期間を1〜100年で入力してください。');
return;
}
if (principal <= 0 && monthly <= 0) {
alert('元本または毎月の積立額を入力してください。');
return;
}
var monthlyRate = rate / 100 / 12;
var totalMonths = years * 12;
yearlyTbody.innerHTML = '';
var balance = principal;
var totalInvested = principal;
for (var year = 1; year <= years; year++) {
for (var month = 0; month < 12; month++) {
balance = balance * (1 + monthlyRate) + monthly;
}
totalInvested = principal + monthly * 12 * year;
var interest = balance - totalInvested;
var tr = document.createElement('tr');
tr.innerHTML =
'<td style="padding: 6px 8px; text-align: right; border-bottom: 1px solid var(--color-border);">' + year + '年目</td>' +
'<td style="padding: 6px 8px; text-align: right; border-bottom: 1px solid var(--color-border);">' + formatYen(totalInvested) + '</td>' +
'<td style="padding: 6px 8px; text-align: right; border-bottom: 1px solid var(--color-border);">' + formatYen(interest) + '</td>' +
'<td style="padding: 6px 8px; text-align: right; border-bottom: 1px solid var(--color-border);">' + formatYen(balance) + '</td>';
yearlyTbody.appendChild(tr);
}
var finalInvested = principal + monthly * 12 * years;
var profit = balance - finalInvested;
var returnRate = finalInvested > 0 ? (profit / finalInvested * 100) : 0;
resultTotal.textContent = formatYen(balance);
resultInvested.textContent = formatYen(finalInvested);
resultProfit.textContent = formatYen(profit);
resultReturnRate.textContent = returnRate.toFixed(1) + '%';
resultSection.hidden = false;
tableContainer.hidden = false;
resultSection.scrollIntoView({ behavior: 'smooth' });
});
resetBtn.addEventListener('click', function () {
principalInput.value = '';
rateInput.value = '';
yearsInput.value = '';
monthlyInput.value = '0';
resultSection.hidden = true;
tableContainer.hidden = true;
yearlyTbody.innerHTML = '';
});
});